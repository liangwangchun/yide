/**
 @Name : jeDate v2.0 手机移动端日期控件
 @Author: chne guojun
 @Date: 2015-12-28
 @QQ群：516754269
 @Site：https://github.com/singod/jeDate
 */
!function(a){var g,h,i,b={},c=document,d="#jedatebox",e="#jedatemask",f=b.query=function(a){return c.querySelectorAll(a)};b.each=function(a,b){for(var c=0,d=a.length;d>c&&b(c,a[c])!==!1;c++);},b.extend=function(){var d,a=function e(a,b){for(var c in a)if(a.hasOwnProperty(c)){if(a[c]instanceof Object&&b[c]instanceof Object&&e(a[c],b[c]),b.hasOwnProperty(c))continue;b[c]=a[c]}},b={},c=arguments;if(!c.length)return{};for(d=c.length-1;d>=0;d--)a(c[d],b);return c[0]=b,b},b.attr=function(a,b,c){return"string"==typeof b&&"undefined"==typeof c?a.getAttribute(b):(a.setAttribute(b,c),this)},b.stopmp=function(b){return b=b||a.event,b.stopPropagation(),this},b.hasClass=function(a,b){return a=a||{},new RegExp("\\b"+b+"\\b").test(a.className)},b.addClass=function(a,c){return a=a||{},b.hasClass(a,c)||(a.className+=" "+c),a.className=a.className.replace(/^\s|\s$/g,"").replace(/\s+/g," "),this},b.removeClass=function(a,c){return a=a||{},b.hasClass(a,c)&&(a.className=a.className.replace(new RegExp("(\\s|^)"+c+"(\\s|$)"),"")),this},b.on=function(a,b){var c;return/Android|iPhone|SymbianOS|Windows Phone|iPad|iPod/.test(navigator.userAgent)?(a.addEventListener("touchmove",function(){c=!0},!1),a.addEventListener("touchend",function(a){a.preventDefault(),c||b.call(this,a),c=!1},!1),void 0):a.addEventListener("click",function(a){b.call(this,a)},!1)},b.html=function(a,b){return void 0===b||1!==a.nodeType?a.innerHTML:(a.innerHTML=b,this)},b.text=function(a,b){if(void 0===b||1!==a.nodeType){var c=a.textContent;return c}return a.textContent=b,this},b.val=function(a,b){return void 0===b||1!==a.nodeType?a.value:(a.value=b,this)},b.parse=function(a,c,d){a=a.concat(c);var d=d;return d.replace(/YYYY|MM|DD|hh|mm|ss/g,function(){return a.index=0|++a.index,b.digit(a[a.index])})},b.nowDate=function(a,c){var d=new Date(0|a?function(a){return 864e5>a?+new Date+864e5*a:a}(parseInt(a)):+new Date);return b.parse([d.getFullYear(),d.getMonth()+1,d.getDate()],[d.getHours(),d.getMinutes(),d.getSeconds()],c)},b.montharr=[1,2,3,4,5,6,7,8,9,10,11,12],b.isValHtml=function(a){return/textarea|input/.test(a.tagName.toLocaleLowerCase())},b.weeks=["日","一","二","三","四","五","六"],b.festival=function(a,b){var c="";switch(a){case"01.01":c="元旦";break;case"02.14":c="情人";break;case"03.08":c="妇女";break;case"04.05":c="清明";break;case"05.01":c="劳动";break;case"06.01":c="儿童";break;case"08.01":c="建军";break;case"09.10":c="教师";break;case"10.01":c="国庆";break;case"12.24":c="平安";break;case"12.25":c="圣诞";break;default:c=b}return c},b.digit=function(a){return 10>a?"0"+(0|a):a},b.shdeCell=function(a){a?b.removeClass(f(d)[0],"dateshow"):b.addClass(f(d)[0],"dateshow"),a?b.removeClass(f(e)[0],"dateshow"):b.addClass(f(e)[0],"dateshow")},g={dateCell:"#dateval",format:"YYYY-MM-DD hh:mm:ss",minDate:"1900-01-01 00:00:00",maxDate:"2099-12-31 23:59:59",isinitVal:!1,isTime:!1,isClear:!0,festival:!1,zIndex:999,choosefun:function(){},clearfun:function(){},okfun:function(){}},h=function(a){var c=this,d=JSON.parse(JSON.stringify(g));c.config=b.extend(d,a),c.init()},i=function(a){return new h(a||{})},h.prototype={init:function(){var i,l,p,a=this,g=a.config,h=f(g.dateCell)[0],k=window.event,m=c.createElement("div"),n=c.createElement("div");f(d)[0]||f(e)[0]||b.each([m,n],function(a,b){b.className=b.id=b==m?d.replace("#",""):e.replace("#",""),b.style.zIndex=g.zIndex+(0==a?5:0),c.body.appendChild(b)});try{l=k.target||k.srcElement||{}}catch(o){l={}}if(i=g.dateCell?f(g.dateCell)[0]:l,p=b.nowDate(null,g.format),g.isinitVal&&(""==(b.val(h)||b.text(h))?b.isValHtml(h)?b.val(h,p):b.text(h,p):b.isValHtml(h)?b.val(h):b.text(h)),k&&l.tagName){if(!i||i===b.elem)return;b.stopmp(k),a.setHtml(g,h)}else b.each((0|i.length)>0?i:[i],function(c,d){b.on(d,function(c){b.stopmp(c),d!==b.elem&&a.setHtml(g,h)})})},setHtml:function(a,c){var k,l,m,n,o,e=this,g="",h=new Date,i=b.nowDate(null,a.format);for("YYYY-MM"==a.format.match(/\w+|d+/g).join("-")?!0:!1,k=a.isinitVal?b.isValHtml(c)?b.val(c):b.text(c):""==(b.val(c)||b.text(c))?i:b.isValHtml(c)?b.val(c):b.text(c),l=""!=b.val(c)||""!=b.text(c)?k.match(/\d+/g):[h.getFullYear(),h.getMonth()+1,h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds()],m='<div class="jedatetop"><div class="jedateym" ><i class="prev triangle yearprev"></i><span class="jedateyear"></span><i class="next triangle yearnext"></i></div><div class="jedateym" ><i class="prev triangle monthprev"></i><span class="jedatemonth"></span><i class="next triangle monthnext"></i></div></div><ol class="jedaol"></ol><ul class="jedaul in"></ul><div class="jedatebot"><ul class="botflex jedatehms"><li><em data-hms="24"></em><i>:</i></li><li><em data-hms="60"></em><i>:</i></li><li><em data-hms="60"></em></li></ul><div class="botflex jedatebtn"><span class="jedateclear">清空</span><span class="jedatetoday">今天</span><span class="jedateok">关闭</span></div></div><div id="jedateprophms"></div>',b.html(f(d)[0],m),a.isClear?"":f("#jedateclear").style.display="none",n=0;n<b.weeks.length;n++)g+='<li class="weeks" data-week="'+b.weeks[n]+'">'+b.weeks[n]+"</li>";b.html(f(d+" .jedaol")[0],g),a.isTime?(o=""!=b.val(c)||""!=b.text(c)?[l[3],l[4],l[5]]:[h.getHours(),h.getMinutes()+1,h.getSeconds()],b.each(f(d+" .jedatebot .jedatehms em"),function(a,c){b.html(c,b.digit(o[a]))})):f(d+" .jedatebot .jedatehms")[0].style.display="none",e.getDateStr(l[0],l[1],l[2]),b.shdeCell(!1),e.events(e,a,c,l)},getDateStr:function(a,c,e){function W(a,b){var c=0==a%4&&0!=a%100||0==a%400?29:28;return[31,c,31,30,31,30,31,31,30,31,30,31][b-1]}function X(a,b){return parseInt(new Date(a,b-1,0).getDate())}var j,k,m,n,o,p,r,s,t,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,P,Q,R,S,T,U,V,g=this,h=g.config,i="";for(c=b.digit(c),b.text(f(d+" .jedateyear")[0],a+"年").attr(f(d+" .jedateyear")[0],"data-year",a),b.text(f(d+" .jedatemonth")[0],c+"月").attr(f(d+" .jedatemonth")[0],"data-month",c),j=function(a,c){return h.festival?b.festival(a,c):c},k=function(a){var b=a.split(" ");return b[0].split("-")},W(a,c),m=new Date(a,parseInt(c)-1,1).getDay(),n=0!=m?m:m+7,o=X(a,c),p=X(a,parseInt(c)+1),r=1,s=k(h.minDate),t=k(h.maxDate),u=p,new Date(a,c,e),w=new Date(a,c,1),x=new Date(a,c,p),y=new Date(s[0],s[1],s[2]),z=new Date(t[0],t[1],t[2]),A=y.getDate(),y>x?r=parseInt(p)+1:y>=w&&x>=y&&(r=A),z&&(B=z.getDate(),w>z?u=r:z>=w&&x>=z&&(u=B)),C=n-1;C>=0;C--)G=b.digit(o-C),1==c?(D=parseInt(a)-1,E=13):(D=a,E=c),H=parseInt(D.toString()+b.digit(parseInt(E)-1).toString()+G.toString()),I=parseInt(s[0].toString()+b.digit(s[1]).toString()+b.digit(s[2]).toString()),J=parseInt(t[0].toString()+b.digit(t[1]).toString()+b.digit(t[2]).toString()),F=H>=I&&J>=H?"prevdate":F="disabled",i+="<li class='"+F+"' data-y='"+D+"' data-m='"+(parseInt(E)-1)+"' data-d='"+G+"'>"+j(parseInt(E)-1+"."+G,G)+"</li>";for(K=1;r>K;K++)K=b.digit(K),i+='<li class="disabled" data-y="'+a+'" data-m="'+c+'" data-d="'+K+'">'+j(c+"."+K,K)+"</li>";for(L=r;u>=L;L++)M="",L=b.digit(L),e==L&&(M="action"),i+='<li class="'+M+'" data-y="'+a+'" data-m="'+c+'" data-d="'+L+'">'+j(c+"."+L,L)+"</li>";for(N=u+1;p>=N;N++)N=b.digit(N),i+='<li class="disabled" data-y="'+a+'" data-m="'+c+'" data-d="'+N+'">'+j(c+"."+N,N)+"</li>";for(P=42-n-W(a,c),Q=1;P>=Q;Q++)Q=b.digit(Q),c>=12?(R=parseInt(a)+1,S=0):(R=a,S=c),U=parseInt(R.toString()+b.digit(parseInt(S)+1).toString()+b.digit(Q).toString()),V=parseInt(s[0].toString()+b.digit(s[1]).toString()+b.digit(s[2]).toString()),J=parseInt(t[0].toString()+b.digit(t[1]).toString()+b.digit(t[2]).toString()),T=J>=U&&U>=V?"nextdate":T="disabled",i+="<li class='"+T+"' data-y='"+R+"' data-m='"+(parseInt(S)+1)+"' data-d='"+Q+"'>"+j(parseInt(S)+1+"."+Q,Q)+"</li>";b.html(f(d+" .jedaul")[0],i),b.attr(f(d+" .monthprev")[0],"data-y",b.digit(parseInt(c)-1)),b.attr(f(d+" .monthnext")[0],"data-y",b.digit(parseInt(c)+1))},events:function(a,c,g,h){var i=f(d+" .yearprev")[0],j=f(d+" .yearnext")[0],k=f(d+" .monthprev")[0],l=f(d+" .monthnext")[0],m=new Date,n=f(d+" .jedateyear")[0],o=f(d+" .jedatemonth")[0];b.each([i,j],function(d,e){b.on(e,function(d){var f,j,k;b.stopmp(d),f=parseInt(b.attr(n,"data-year")),j=parseInt(b.attr(o,"data-month")),e==i?f-=1:f+=1,k=m.toLocaleDateString()==f+"/"+j+"/"+m.getDate()?h[2]:1,a.getDateStr(f,j,k),a.clickLiDays(a,c,g)})}),b.each([k,l],function(d,e){b.on(e,function(d){var f,i,j;b.stopmp(d),f=parseInt(b.attr(n,"data-year")),i=parseInt(b.attr(o,"data-month")),e==k?1==i?(f-=1,i=12):i-=1:12==i?(f+=1,i=1):i+=1,j=m.toLocaleDateString()==f+"/"+i+"/"+m.getDate()?h[2]:1,a.getDateStr(f,i,j),a.clickLiDays(a,c,g)})}),b.each(f(d+" .jedatehms em"),function(a,c){b.on(c,function(){var e,j,d="",g=f("#jedateprophms")[0],h=b.attr(this,"data-hms"),i=["小时","分钟","秒数"];for(d+='<div class="jedatehmstitle">'+i[a]+'<div class="jedatehmsclose"></div></div>',j=0;h>j;j++)e=b.text(this)==j?"action":"",d+='<p class="'+e+'">'+j+"</p>";b.attr(g,"class","").attr(g,"class",24==h?"jedateh":"jedatems"),b.html(g,d),b.each(f("#jedateprophms p"),function(a,d){b.on(d,function(){b.text(c,b.digit(b.text(this))),b.attr(g,"class",""),b.html(g,"")})}),b.each(f("#jedateprophms .jedatehmstitle"),function(a,c){b.on(c,function(){b.attr(g,"class",""),b.html(g,"")})})})}),b.on(f(d+" .jedatebot .jedatetoday")[0],function(){var e=[m.getFullYear(),m.getMonth()+1,m.getDate(),m.getHours(),m.getMinutes(),m.getSeconds()],h=b.parse([e[0],e[1],e[2]],[e[3],e[4],e[5]],c.format);a.getDateStr(e[0],e[1],e[2]),b.isValHtml(g)?b.val(g,h):b.text(g,h),b.html(f(d)[0],""),b.shdeCell(!0),("function"===c.choosefun||null!=c.choosefun)&&c.choosefun(h)}),b.on(f(d+" .jedatebot .jedateclear")[0],function(){var a=b.isValHtml(g)?b.val(g):b.text(g);b.isValHtml(g)?b.val(g,""):b.text(g,""),b.html(f(d)[0],""),b.shdeCell(!0),""!=a&&("function"===c.clearfun||null!=c.clearfun)&&c.clearfun(a)}),b.on(f(d+" .jedatebot .jedateok")[0],function(a){b.stopmp(a),b.html(f(d)[0],""),b.shdeCell(!0)}),b.on(f(e)[0],function(){b.shdeCell(!0),b.html(f(d)[0],"")}),a.clickLiDays(a,c,g)},clickLiDays:function(a,c,e){b.each(f(d+" .jedaul li"),function(g,h){b.on(h,function(g){var i,j,k,l,m;b.hasClass(h,"disabled")||(b.stopmp(g),i=[],b.each(f(d+" .jedatehms em"),function(a,c){i.push(b.text(c))}),j=0|parseInt(b.attr(h,"data-y")),k=0|parseInt(b.attr(h,"data-m")),l=0|parseInt(b.attr(h,"data-d")),m=b.parse([j,k,l],[i[0],i[1],i[2]],c.format),a.getDateStr(j,k,l),b.isValHtml(e)?b.val(e,m):b.text(e,m),b.html(f(d)[0],""),b.shdeCell(!0),("function"===c.choosefun||null!=c.choosefun)&&c.choosefun(m))})})}},b.getPath=function(){var a=document.scripts,b=a[a.length-1].src;return b.substring(0,b.lastIndexOf("/")+1)}(),b.creatlink=function(a){var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=b.getPath+"skin/"+a+".css",c.id="jemDateSkin",f("head")[0].appendChild(c),c=null},b.creatlink("jedate"),i.skin=function(a){f("#jeDateSkin")[0].parentNode.removeChild(f("#jeDateSkin")[0]),b.creatlink(a)},i.now=function(a){var c,d,e,b=new Date;return b.setDate(b.getDate()+a),c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),c+"-"+d+"-"+e},"function"==typeof define?define(function(){return i}):window.jeDate=i}(window);